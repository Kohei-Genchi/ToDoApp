
<!doctype html>
<html lang="en">

<head>
    <title>Code coverage report for www/public/build/assets/TaskModal-Cusl9no8.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../../prettify.css" />
    <link rel="stylesheet" href="../../../../base.css" />
    <link rel="shortcut icon" type="image/x-icon" href="../../../../favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../../sort-arrow-sprite.png);
        }
    </style>
</head>
    
<body>
<div class='wrapper'>
    <div class='pad1'>
        <h1><a href="../../../../index.html">All files</a> / <a href="index.html">www/public/build/assets</a> TaskModal-Cusl9no8.js</h1>
        <div class='clearfix'>
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Statements</span>
                <span class='fraction'>0/1</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Branches</span>
                <span class='fraction'>0/1</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Functions</span>
                <span class='fraction'>0/1</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Lines</span>
                <span class='fraction'>0/1</span>
            </div>
        
            
        </div>
        <p class="quiet">
            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
        </p>
        <template id="filterTemplate">
            <div class="quiet">
                Filter:
                <input type="search" id="fileSearch">
            </div>
        </template>
    </div>
    <div class='status-line low'></div>
    <pre><table class="coverage">
<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
<a name='L2'></a><a href='#L2'>2</a></td><td class="line-coverage quiet"><span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js"><span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" ><span class="branch-0 cbranch-no" title="branch not covered" >import{_ as M,c as s,o as u,a as d,t as f,w as F,d as b,j as c,f as j,v as y,k as C,F as V,r as p,e as U,l as h,h as E,b as T,i as _,m as N,p as k}from"./app-D57cpfvF.js";const O={props:{mode:{type:String,default:"add",validator:r=&gt;["add","edit"].includes(r)},todoId:{type:Number,default:null},todoData:{type:Object,default:()=&gt;({title:"",description:"",due_date:"",due_time:"",category_id:"",recurrence_type:"none",recurrence_end_date:""})},categories:{type:Array,default:()=&gt;[]},currentDate:{type:String,default:""},currentView:{type:String,default:"today"}},emits:["close","submit","delete","category-created"],setup(r,{emit:o}){console.log("TaskModal setup - Mode:",r.mode),console.log("Categories received:",r.categories),console.log("todoData received:",r.todoData),console.log("todoId received:",r.todoId);function g(t){if(!t)return"";try{if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const l=new Date(t);return`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`}catch(l){return console.error("Error formatting date:",l,t),""}}const e=h({title:"",description:"",due_date:"",due_time:"",category_id:"",recurrence_type:"none",recurrence_end_date:""}),x=E(!1),m=h({name:"",color:"#3b82f6"}),n=T(()=&gt;r.categories?Array.isArray(r.categories)?r.categories.map(t=&gt;({...t,id:String(t.id)})):(console.error("Categories prop is not an array:",r.categories),[]):[]),S=T(()=&gt;e.category_id&amp;&amp;n.value.find(t=&gt;String(t.id)===String(e.category_id))||null);function v(){if(console.log("Initializing form with data:",r.todoData),!r.todoData){console.warn("TodoData is null or undefined"),r.mode==="add"&amp;&amp;(e.title="",e.description="",e.due_date=r.currentDate||"",e.due_time="",e.category_id="",e.recurrence_type="none",e.recurrence_end_date="");return}if(e.title=r.todoData.title||"",e.description=r.todoData.description||"",e.due_date=r.todoData.due_date?g(r.todoData.due_date):"",r.todoData.due_time)if(typeof r.todoData.due_time=="string"&amp;&amp;r.todoData.due_time.includes("T")){const t=new Date(r.todoData.due_time);e.due_time=`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}else{const t=r.todoData.due_time.split(":");t.length&gt;=2?e.due_time=`${t[0]}:${t[1]}`:e.due_time=r.todoData.due_time}else e.due_time="";r.todoData.category_id!==null&amp;&amp;r.todoData.category_id!==void 0?(e.category_id=String(r.todoData.category_id),console.log("Setting category_id to:",e.category_id)):e.category_id="",e.recurrence_type=r.todoData.recurrence_type||"none",e.recurrence_end_date=r.todoData.recurrence_end_date?g(r.todoData.recurrence_end_date):"",console.log("Form initialized with:",{...e})}_(()=&gt;r.todoData,t=&gt;{console.log("TodoData changed:",t),k(()=&gt;{v()})},{immediate:!0,deep:!0}),_(()=&gt;r.mode,t=&gt;{console.log("Mode changed to:",t),k(()=&gt;{v()})},{immediate:!0}),_(()=&gt;r.currentDate,t=&gt;{r.mode==="add"&amp;&amp;!e.due_date&amp;&amp;t&amp;&amp;(e.due_date=g(t))},{immediate:!0}),_(()=&gt;r.categories,t=&gt;{console.log("Categories updated in TaskModal:",t),t&amp;&amp;(console.log("Categories type:",typeof t),console.log("Is array:",Array.isArray(t)),console.log("Length:",t.length),Array.isArray(t)&amp;&amp;t.length&gt;0&amp;&amp;console.log("First category:",t[0]))},{immediate:!0,deep:!0}),N(()=&gt;{console.log("TaskModal mounted - TodoID:",r.todoId,"Mode:",r.mode),console.log("Categories on mount:",r.categories),r.categories&amp;&amp;(console.log("Categories type on mount:",typeof r.categories),console.log("Is array on mount:",Array.isArray(r.categories)),console.log("Length on mount:",r.categories.length),Array.isArray(r.categories)&amp;&amp;r.categories.length&gt;0&amp;&amp;console.log("First category on mount:",r.categories[0])),k(()=&gt;{v()})});function w(t,l){if(!t)return null;try{const a=l?`${t}T${l}`:`${t}T00:00:00`;return new Date(a).toISOString()}catch(a){return console.error("UTC conversion error:",a),null}}function D(){if(console.log("Submit button clicked"),console.log("Submitting form with data:",{...e}),!e.title.trim()){alert("タイトルを入力してください");return}const t={...e};if(t.due_date){const i=w(t.due_date,t.due_time);i&amp;&amp;(t.due_date=i.split("T")[0],t.due_time=i.split("T")[1].substring(0,5))}t.user_timezone=Intl.DateTimeFormat().resolvedOptions().timeZone,t.category_id!==""&amp;&amp;t.category_id!==null?t.category_id=Number(t.category_id):t.category_id=null,console.log("Processed form data for submission:",t),r.mode==="edit"&amp;&amp;r.todoId&amp;&amp;(console.log("Emitting submit event with task ID:",r.todoId),t.id=r.todoId);const l=t.category_id!==null?n.value.find(i=&gt;Number(i.id)===t.category_id):null,a={...t,category:l};console.log("Emitting task with category:",a),o("submit",a),o("close")}async function I(){if(!m.name.trim()){alert("カテゴリー名を入力してください");return}console.log("Creating category:",m);try{const t=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),l=await fetch("/api/categories",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({name:m.name.trim(),color:m.color}),credentials:"include"});if(!l.ok){const i=await l.json();throw new Error(i.message||"Error creating category")}const a=await l.json();console.log("Category created successfully:",a),e.category_id=String(a.id),x.value=!1,o("category-created"),m.name="",m.color="#3b82f6",alert("カテゴリーが作成されました")}catch(t){console.error("Error creating category:",t),alert("カテゴリーの作成に失敗しました: "+t.message)}}function A(){if(console.log("Delete task button clicked for task ID:",r.todoId),!r.todoId){console.error("No task ID found");return}const t=e.recurrence_type&amp;&amp;e.recurrence_type!=="none";console.log("Emitting delete event with id:",r.todoId,"deleteAllRecurring:",t),o("delete",r.todoId,t)}return{form:e,showCategoryInput:x,newCategory:m,categoriesArray:n,getSelectedCategory:S,submitForm:D,createCategory:I,deleteTask:A,props:r,submitForm:D,convertToUTC:w}}},z={class:"fixed inset-0 flex items-center justify-center z-10","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},L={class:"bg-white rounded-lg shadow-lg w-full max-w-xl relative z-10 flex flex-col max-h-[90vh]"},R={class:"px-4 py-3 border-b border-gray-200 bg-gray-50 flex justify-between items-center"},q={id:"modal-title",class:"text-lg font-medium text-gray-800"},B={class:"p-4 overflow-y-auto"},P={class:"grid grid-cols-2 gap-3"},X={class:"flex justify-between items-center"},H={key:0,class:"mt-1"},J=["value"],K={key:0,class:"mt-1 p-1 bg-gray-50 rounded-md text-xs flex items-center"},W={key:1,class:"mt-1 space-y-2 p-2 border border-gray-200 rounded-md bg-gray-50"},Y={class:"flex gap-2"},Z={class:"flex-grow"},G={class:"w-24"},Q={class:"flex justify-end gap-2"},$={key:0,class:"pb-1"},ee={class:"bg-gray-50 px-4 py-2 border-t border-gray-200 mt-auto"},te={class:"flex justify-between items-center"},oe={key:0},re={key:1,class:"flex-1"},de={class:"flex gap-2"};function ne(r,o,g,e,x,m){return u(),s("div",z,[d("div",{class:"absolute inset-0 bg-black bg-opacity-40",onClick:o[0]||(o[0]=n=&gt;r.$emit("close"))}),d("div",L,[d("div",R,[d("h3",q,f(g.mode==="add"?"新しいタスク":"タスクを編集"),1),d("button",{onClick:o[1]||(o[1]=n=&gt;r.$emit("close")),class:"text-gray-400 hover:text-gray-500"},o[17]||(o[17]=[d("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),d("div",B,[d("form",{onSubmit:o[13]||(o[13]=F((...n)=&gt;e.submitForm&amp;&amp;e.submitForm(...n),["prevent"])),class:"space-y-2"},[d("div",null,[o[18]||(o[18]=d("label",{for:"title",class:"block text-sm font-medium text-gray-700"},[j(" タイトル"),d("span",{class:"text-red-500"},"*")],-1)),c(d("input",{type:"text",id:"title","onUpdate:modelValue":o[2]||(o[2]=n=&gt;e.form.title=n),required:"",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-1.5 px-3 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[y,e.form.title]])]),d("div",null,[o[19]||(o[19]=d("label",{for:"description",class:"block text-sm font-medium text-gray-700"},"説明",-1)),c(d("textarea",{id:"description","onUpdate:modelValue":o[3]||(o[3]=n=&gt;e.form.description=n),rows:"2",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-1.5 px-3 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[y,e.form.description]])]),d("div",P,[d("div",null,[o[20]||(o[20]=d("label",{for:"due_date",class:"block text-sm font-medium text-gray-700"},"期限日",-1)),c(d("input",{type:"date",id:"due_date","onUpdate:modelValue":o[4]||(o[4]=n=&gt;e.form.due_date=n),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-1.5 px-3 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[y,e.form.due_date]])]),d("div",null,[o[21]||(o[21]=d("label",{for:"due_time",class:"block text-sm font-medium text-gray-700"},"時間",-1)),c(d("input",{type:"time",id:"due_time","onUpdate:modelValue":o[5]||(o[5]=n=&gt;e.form.due_time=n),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-1.5 px-3 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[y,e.form.due_time]])])]),d("div",null,[d("div",X,[o[22]||(o[22]=d("label",{for:"category_id",class:"block text-sm font-medium text-gray-700"},"カテゴリー",-1)),d("button",{type:"button",onClick:o[6]||(o[6]=n=&gt;e.showCategoryInput=!e.showCategoryInput),class:"text-xs text-blue-600 hover:text-blue-800"},f(e.showCategoryInput?"戻る":"新規カテゴリー"),1)]),e.showCategoryInput?b("",!0):(u(),s("div",H,[c(d("select",{id:"category_id","onUpdate:modelValue":o[7]||(o[7]=n=&gt;e.form.category_id=n),class:"block w-full border border-gray-300 rounded-md shadow-sm py-1.5 px-3 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[o[23]||(o[23]=d("option",{value:""},"カテゴリーなし",-1)),(u(!0),s(V,null,p(e.categoriesArray,n=&gt;(u(),s("option",{key:n.id,value:n.id},f(n.name),9,J))),128))],512),[[C,e.form.category_id]]),e.form.category_id&amp;&amp;e.getSelectedCategory?(u(),s("div",K,[d("div",{class:"w-3 h-3 rounded-full mr-1",style:U({backgroundColor:e.getSelectedCategory.color})},null,4),d("span",null,f(e.getSelectedCategory.name),1)])):b("",!0)])),e.showCategoryInput?(u(),s("div",W,[d("div",Y,[d("div",Z,[c(d("input",{type:"text",id:"new_category_name","onUpdate:modelValue":o[8]||(o[8]=n=&gt;e.newCategory.name=n),placeholder:"カテゴリー名",class:"w-full border border-gray-300 rounded-md shadow-sm py-1 px-2 text-sm"},null,512),[[y,e.newCategory.name]])]),d("div",G,[c(d("input",{type:"color",id:"new_category_color","onUpdate:modelValue":o[9]||(o[9]=n=&gt;e.newCategory.color=n),class:"w-full h-7 border border-gray-300 rounded-md p-0"},null,512),[[y,e.newCategory.color]])])]),d("div",Q,[d("button",{typ</span></span>e:"button",onClick:o[10]||(o[10]=(...n)=&gt;e.createCategory&amp;&amp;e.createCategory(...n)),class:"px-2 py-1 text-xs bg-blue-600 text-white rounded-md hover:bg-blue-700"}," 追加 ")])])):b("",!0)]),d("div",null,[o[25]||(o[25]=d("label",{for:"recurrence_type",class:"block text-sm font-medium text-gray-700"},"繰り返し",-1)),c(d("select",{id:"recurrence_type","onUpdate:modelValue":o[11]||(o[11]=n=&gt;e.form.recurrence_type=n),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-1.5 px-3 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},o[24]||(o[24]=[d("option",{value:"none"},"繰り返しなし",-1),d("option",{value:"daily"},"毎日",-1),d("option",{value:"weekly"},"毎週",-1),d("option",{value:"monthly"},"毎月",-1)]),512),[[C,e.form.recurrence_type]])]),e.form.recurrence_type&amp;&amp;e.form.recurrence_type!=="none"?(u(),s("div",$,[o[26]||(o[26]=d("label",{for:"recurrence_end_date",class:"block text-sm font-medium text-gray-700"},"繰り返し終了日",-1)),c(d("input",{type:"date",id:"recurrence_end_date","onUpdate:modelValue":o[12]||(o[12]=n=&gt;e.form.recurrence_end_date=n),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-1.5 px-3 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[y,e.form.recurrence_end_date]]),o[27]||(o[27]=d("p",{class:"mt-0.5 text-xs text-gray-500"}," ※指定しない場合は1ヶ月間繰り返されます ",-1))])):b("",!0)],32)]),d("div",ee,[d("div",te,[g.mode==="edit"?(u(),s("div",oe,[d("button",{type:"button",onClick:o[14]||(o[14]=(...n)=&gt;e.deleteTask&amp;&amp;e.deleteTask(...n)),class:"inline-flex items-center px-2.5 py-1.5 text-xs font-medium rounded border border-red-300 text-red-700 bg-white hover:bg-red-50"}," 削除 ")])):(u(),s("div",re)),d("div",de,[d("button",{type:"button",onClick:o[15]||(o[15]=n=&gt;r.$emit("close")),class:"inline-flex items-center px-2.5 py-1.5 text-xs font-medium rounded border border-gray-300 text-gray-700 bg-white hover:bg-gray-50"}," キャンセル "),d("button",{type:"button",onClick:o[16]||(o[16]=(...n)=&gt;e.submitForm&amp;&amp;e.submitForm(...n)),class:"inline-flex items-center px-2.5 py-1.5 text-xs font-medium rounded border border-transparent text-white bg-blue-600 hover:bg-blue-700"},f(g.mode==="add"?"追加":"保存"),1)])])])])])}const ae=M(O,[["render",ne]]);export{ae as default};</span>
&nbsp;</pre></td></tr></table></pre>

                <div class='push'></div><!-- for sticky footer -->
            </div><!-- /wrapper -->
            <div class='footer quiet pad2 space-top1 center small'>
                Code coverage generated by
                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
                at 2025-03-14T14:46:55.130Z
            </div>
        <script src="../../../../prettify.js"></script>
        <script>
            window.onload = function () {
                prettyPrint();
            };
        </script>
        <script src="../../../../sorter.js"></script>
        <script src="../../../../block-navigation.js"></script>
    </body>
</html>
    